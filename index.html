<!doctype html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, user-scalable=yes" />
<style>
	body {
    margin:0;
    border: 0;
    padding: 0;
	}
	
	#container {
	height: 100%;
	width: 100%;
	}

	#sketch {
	/*height: 100%;
	width: 100%;*/
 	margin: 0 auto;
	}
	</style>
	
</head>
<title>Demo</title>
<body>
<div id="container">
<canvas id="sketch" data-paper-keepalive="true" keepalive="true" width="702" height="702"></canvas>
<div id="tweets"></div>
</div> 
<script src="/socket.io/socket.io.js"></script>
<script src="http://www.jacopocolo.com/paperjs/js/paper-full.min.js"></script>

<script>
var children;

window.onload = function() {
var canvas = document.getElementById('sketch');
paper.setup(canvas);

var halfx = canvas.height/2;
var halfy = canvas.width/2;
var velocita = canvas.height/600;

//jangoFett, father of all the clones
var jangofett = new paper.Shape.Circle({
    center: [halfx, halfy],
    radius: 10
});

children = paper.project.activeLayer.children;

paper.view.onFrame = function(event) {

for (var i = 1; i < children.length; i++) {
	children[i].radius += velocita;
	if (children[i].radius > canvas.height) {
		children[i].remove();
		}
	}

paper.view.draw();
};

//SOCKET.IO

var socket = io.connect('/'),
  
  tweets = document.getElementById('tweets');
  socket.on('tweet', function (data, data_followers, datacolore) {
  //  tweets.innerHTML = tweets.innerHTML + '<br>' + data;
    console.log(data);
    drawLine(data_followers, datacolore);
    });
  
  socket.on('connect', function(){
                      socket.emit('search', prompt("What do you want to search on Twitter?"));
                  });
                  
function drawLine(followers, color) {
	
	var spessore;

	if (followers < 10) {
	spessore = 1
	} else if (followers > 10 && followers <= 100) {
	spessore = 2
	} else if (followers > 100 && followers <= 1000) {
	spessore = 3
	} else if (followers > 1000 && followers <= 10000) {
	spessore = 4
	} else if (followers > 10000 && followers <= 100000) {
	spessore = 5
	} else if (followers > 1000000) {spessore = 6};
	 	
 	//all the stormstroopers are Jango's clones
 	var stormtrooper = jangofett.clone();
 	
 	//per qualche motivo questi non funzionano...
 	stormtrooper.strokeColor = "#"+color;
 	stormtrooper.strokeWidth = spessore;
 	
	};
	
	paper.view.draw();
};
</script>
</body>